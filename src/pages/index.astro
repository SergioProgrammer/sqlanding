---
import Layout from "@/layouts/Layout.astro"
// Imagenes
import HeroKeyLogo from "@/assets/hero-key-logo.svg" // Este es el logo inicial

// logos
import Logo1 from "@/assets/logos/logo1.svg"
import Logo2 from "@/assets/logos/logo2.svg"
import Logo3 from "@/assets/logos/logo3.svg"
import Logo4 from "@/assets/logos/logo4.svg"
import Logo5 from "@/assets/logos/logo5.svg"
import Logo6 from "@/assets/logos/logo6.svg"
import Logo7 from "@/assets/logos/logo7.svg"
import Logo8 from "@/assets/logos/logo8.svg"
import Logo9 from "@/assets/logos/logo9.svg"
import Logo10 from "@/assets/logos/logo10.svg"
import Logo11 from "@/assets/logos/logo11.svg"
---

<Layout>
  <div id="intro-animation-container" class="fixed top-0 left-0 w-full h-screen z-50">
    <section>
      <picture
        id="hero-key"
        class="h-screen scale-150 block overflow-hidden fixed w-full"
      >
        <div
          id="hero-background-color"
          class="w-full h-full absolute top-0 left-0"
          style="background: #fefba4;" 
        ></div>
        <img
          id="hero-key-logo"
          src={HeroKeyLogo.src}
          class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 max-w-[70vw] max-h-[30vh] sm:w-44 md:w-64 opacity-100 z-20"
          alt="Initial Hero Logo"
        />
      </picture>

      <div id="logo-mask" class="fixed top-0 left-0 w-full h-screen z-10">
          </div>
    </section>
  </div>

  <span
    id="final-message"
    class="fixed flex justify-center items-center top-0 left-0 w-full h-screen text-2xl sm:text-4xl md:text-6xl font-semibold opacity-0 z-40 text-center"
    style="background: #042e36; color: #fbd04a;"
  >
    DISE칌O GR츼FICO Y DESARROLLO WEB
  </span>

  <div
    id="after-hero"
    class="fixed flex flex-col items-center justify-center top-0 left-0 w-full h-screen opacity-0 z-40 text-center px-4"
    style="background: #042e36; color: #fbd04a;"
  >
    <span class="text-lg sm:text-6xl font-semibold drop-shadow mb-32">
      Empresas que conf칤an en nosotros
    </span>
    <div class="flex flex-wrap justify-center gap-4">
      <img src={Logo1.src} alt="Logo 1" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo2.src} alt="Logo 2" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo3.src} alt="Logo 3" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo4.src} alt="Logo 4" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo5.src} alt="Logo 5" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo6.src} alt="Logo 6" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo7.src} alt="Logo 7" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo8.src} alt="Logo 8" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo9.src} alt="Logo 9" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo10.src} alt="Logo 10" class="h-15 sm:h-18 filter grayscale" />
      <img src={Logo11.src} alt="Logo 11" class="h-15 sm:h-18 filter grayscale" />
    </div>
  </div>

  <div
    id="pantalla-diseno"
    class="fixed w-full h-screen flex flex-col items-center justify-center top-0 left-0 opacity-0 z-30 text-center px-4"
    style="background: #fefba4"
  >
    <svg id="figura-circulo" width="100" height="100" class="absolute left-8 top-8 opacity-0">
      <circle cx="50" cy="50" r="40" fill="#FFD700" fill-opacity="0.8" />
    </svg>
    <svg id="figura-triangulo" width="80" height="80" class="absolute right-1/4 top-1/4 opacity-0">
      <polygon points="40,10 70,70 10,70" fill="#00BFFF" fill-opacity="0.8" />
    </svg>
    <svg id="figura-curva" width="120" height="60" class="absolute left-1/3 bottom-1/4 opacity-0">
      <path d="M10 50 Q60 10 110 50" stroke="#FF4500" stroke-width="5" fill="none" stroke-opacity="0.8"/>
    </svg>
    <div class="relative z-10 flex flex-col items-center">
      <svg width="120" height="120" viewBox="0 0 120 120" class="mb-6">
        <circle
          cx="60"
          cy="60"
          r="50"
          fill="#fff"
          fill-opacity="0.1"
          stroke="#fff"
          stroke-width="4"
        />
        <text
          x="50%"
          y="54%"
          text-anchor="middle"
          fill="#fff"
          font-size="22"
          font-weight="bold"
          dy=".3em"
        >
          游꿛
        </text>
      </svg>
      <span class="text-2xl sm:text-4xl font-bold text-white mb-2 drop-shadow">
        Dise침o gr치fico
      </span>
      <span class="text-base sm:text-xl text-white/80">
        Creatividad, identidad visual y comunicaci칩n efectiva para tu marca.
      </span>
    </div>
  </div>

  <div
    id="pantalla-marketing"
    class="fixed flex flex-col items-center justify-center top-0 left-0 w-full h-screen opacity-0 z-30 text-center px-4"
    style="background: #fbd04a"
  >
    <svg id="figura-estrella" width="80" height="80" class="absolute left-1/4 top-8 opacity-0">
      <polygon points="40,5 50,30 75,30 55,45 65,70 40,55 15,70 25,45 5,30 30,30" fill="#FF1493" fill-opacity="0.8"/>
    </svg>
    <svg id="figura-flecha" width="100" height="100" class="absolute right-8 top-1/3 opacity-0">
      <polygon points="20,50 80,50 80,20 100,60 80,100 80,70 20,70" fill="#32CD32" fill-opacity="0.8"/>
    </svg>
    <svg id="figura-ondas" width="150" height="80" class="absolute right-1/4 bottom-8 opacity-0">
      <path d="M5 40 Q40 10 75 40 T145 40" stroke="#FFD700" stroke-width="6" fill="none" stroke-opacity="0.8"/>
    </svg>
    <svg width="120" height="120" viewBox="0 0 120 120" class="mb-6">
      <rect
        x="20"
        y="20"
        width="80"
        height="80"
        rx="20"
        fill="#fff"
        fill-opacity="0.1"
        stroke="#fff"
        stroke-width="4"
      />
      <text
        x="50%"
        y="54%"
        text-anchor="middle"
        fill="#fff"
        font-size="22"
        font-weight="bold"
        dy=".3em"
      >
        游늳
      </text>
    </svg>
    <span class="text-2xl sm:text-4xl font-bold text-white mb-2 drop-shadow">
      Marketing
    </span>
    <span class="text-base sm:text-xl text-white/80">
      Estrategias digitales para crecer y conectar con tu audiencia.
    </span>
  </div>

  <div
    id="pantalla-desarrollo"
    class="fixed flex flex-col items-center justify-center top-0 left-0 w-full h-screen opacity-0 z-30 text-center px-4"
    style="background: #f79b33"
  >
    <svg id="figura-llaves" width="70" height="70" class="absolute left-8 top-8 opacity-0">
      <path d="M10 20 L20 10 L30 20 L20 30 Z M40 40 L50 30 L60 40 L50 50 Z" fill="#ADFF2F" fill-opacity="0.8"/>
    </svg>
    <svg id="figura-corchetes" width="70" height="70" class="absolute right-8 top-8 opacity-0">
      <path d="M20 10 L10 20 L20 30 M50 10 L60 20 L50 30" stroke="#ADFF2F" stroke-width="4" fill="none" stroke-opacity="0.8"/>
    </svg>
    <svg id="figura-bits" width="100" height="30" class="absolute left-1/4 bottom-1/4 opacity-0">
      <circle cx="15" cy="15" r="10" fill="#8A2BE2" fill-opacity="0.7"/>
      <circle cx="50" cy="15" r="10" fill="#8A2BE2" fill-opacity="0.7"/>
      <circle cx="85" cy="15" r="10" fill="#8A2BE2" fill-opacity="0.7"/>
    </svg>
    <svg id="figura-conexion" width="150" height="100" class="absolute right-1/4 top-1/2 opacity-0">
      <line x1="20" y1="20" x2="130" y2="80" stroke="#F0E68C" stroke-width="3" stroke-dasharray="5,5" stroke-opacity="0.8"/>
      <circle cx="20" cy="20" r="5" fill="#F0E68C" fill-opacity="0.8"/>
      <circle cx="130" cy="80" r="5" fill="#F0E68C" fill-opacity="0.8"/>
    </svg>
    <svg width="120" height="120" viewBox="0 0 120 120" class="mb-6">
      <polygon
        points="60,20 100,100 20,100"
        fill="#fff"
        fill-opacity="0.1"
        stroke="#fff"
        stroke-width="4"
      />
      <text
        x="50%"
        y="60%"
        text-anchor="middle"
        fill="#fff"
        font-size="22"
        font-weight="bold"
        dy=".3em"
      >
        游눹
      </text>
    </svg>
    <span class="text-2xl sm:text-4xl font-bold text-white mb-2 drop-shadow">
      Desarrollo web
    </span>
    <span class="text-base sm:text-xl text-white/80">
      Sitios y aplicaciones modernas, r치pidas y seguras.
    </span>
  </div>
</Layout>

<style>
  #logo-mask {
    background: #fefba4; /* Color de fondo para la m치scara */
    mask-image: url("/logo-stack.svg");
    mask-position: center 10%;
    mask-repeat: no-repeat;
    /* Optimizaci칩n: valores m치s sensatos para desktop */
    mask-size: clamp(5000vh, 2000%, 0vh); 
  }

  @media (max-width: 640px) {
    #logo-mask {
      /* Optimizaci칩n: valores m치s peque침os para m칩viles */
      mask-size: clamp(5000vh, 900%, 0vh); /* Reducido del 5000vh/900% */
      mask-position: center 19%;
    }
  }
</style>

<script>
  import { gsap } from "gsap"
  import { ScrollTrigger } from "gsap/ScrollTrigger"

  gsap.registerPlugin(ScrollTrigger)

  // Define propiedades de animaci칩n comunes para las figuras
  const figureEnterProps = {
    opacity: 1,
    scale: 1.1,
    rotate: "random(-360, 360)",
    x: "random(-50, 50)",
    y: "random(-50, 50)",
    duration: 1.5,
    ease: "power3.out",
  };

  const figureExitProps = {
    opacity: 0,
    scale: 0.7,
    rotate: "random(-180, 180)",
    x: "random(-30, 30)",
    y: "random(-30, 30)",
    duration: 0.8,
    ease: "power2.in",
  };

  // --- UNA 칔NICA L칈NEA DE TIEMPO PARA TODA LA ANIMACI칍N (SCRUBBED) ---
  const tl = gsap.timeline({
    ease: "power2.out",
    scrollTrigger: {
      trigger: "body",
      start: "top top",
      // Ajustar el "end" podr칤a ser 칰til para controlar la duraci칩n total del scroll de la animaci칩n
      // Por ejemplo, "top +=4000" para 4000px de scroll para toda la animaci칩n
      end: "bottom bottom",
      scrub: 1,
      // markers: true,
    },
  });

  // Animaciones iniciales: hero-key-logo y logo-mask
  tl.to("#hero-key", { duration: 1, scale: 1 })
    .to("#hero-key-logo", { opacity: 0, duration: 0.5 }, "<")
    .to(
      "#logo-mask", // Animamos el tama침o de la m치scara
      {
        // Optimizaci칩n: valores finales m치s sensatos para desktop
        maskSize: "clamp(7vh, 25%, 0.5vh)",
        duration: 1.5,
      },
      0.3
    )
    .to(
      "#hero-key", // Aseguramos que hero-key tambi칠n se desvanece
      {
        opacity: 0,
        duration: 0.7,
      },
      "<0.5"
    )
    .to(
      "#intro-animation-container", // El contenedor que encapsula la intro
      {
        opacity: 0,
        pointerEvents: "none",
        duration: 0.5,
      },
      ">"
    );

  // --- A침adimos las animaciones para las siguientes pantallas al MISMO timeline ---
  tl.to(
      "#final-message",
      {
        opacity: 1,
        duration: 0.7,
      }
    )
    .to(
      "#final-message",
      {
        opacity: 0,
        duration: 0.5,
        delay: 0.7,
      }
    )
    .to(
      "#after-hero",
      {
        opacity: 1,
        duration: 0.7,
      }
    )
    .to(
      "#after-hero",
      {
        opacity: 0,
        duration: 0.5,
        delay: 1.2,
      }
    )

    // --- PANTALLA DISE칌O GR츼FICO ---
    .to(
      "#pantalla-diseno",
      {
        opacity: 1,
        duration: 0.7,
      }
    )
    .to("#figura-circulo", { ...figureEnterProps, x: -80, y: -80, rotate: 720 }, "<")
    .to("#figura-triangulo", { ...figureEnterProps, x: 50, y: -50, rotate: -360 }, "<0.1")
    .to("#figura-curva", { ...figureEnterProps, x: 30, y: 30, scale: 1.3 }, "<0.2")
    .to(
      "#pantalla-diseno",
      { opacity: 0, duration: 0.5, delay: 1.5 }
    )
    .to("#figura-circulo", figureExitProps, "<")
    .to("#figura-triangulo", figureExitProps, "<0.1")
    .to("#figura-curva", figureExitProps, "<0.2")

    // --- PANTALLA MARKETING ---
    .to(
      "#pantalla-marketing",
      {
        opacity: 1,
        duration: 0.7,
      }
    )
    .to("#figura-estrella", { ...figureEnterProps, rotate: 540, x: -70 }, "<")
    .to("#figura-flecha", { ...figureEnterProps, x: 70, y: -30, scale: 1.0 }, "<0.1")
    .to("#figura-ondas", { ...figureEnterProps, y: 70, scale: 1.2, rotate: -270 }, "<0.2")
    .to(
      "#pantalla-marketing",
      { opacity: 0, duration: 0.5, delay: 1.5 }
    )
    .to("#figura-estrella", figureExitProps, "<")
    .to("#figura-flecha", figureExitProps, "<0.1")
    .to("#figura-ondas", figureExitProps, "<0.2")

    // --- PANTALLA DESARROLLO WEB ---
    .to(
      "#pantalla-desarrollo",
      {
        opacity: 1,
        duration: 0.7,
      }
    )
    .to("#figura-llaves", { ...figureEnterProps, x: -60, rotate: 180 }, "<")
    .to("#figura-corchetes", { ...figureEnterProps, x: 60, rotate: -180 }, "<0.1")
    .to("#figura-bits", { ...figureEnterProps, y: 50, scale: 1.5 }, "<0.2")
    .to("#figura-conexion", { ...figureEnterProps, x: -50, y: 50, rotate: 90 }, "<0.3")

    // Optional: Fade out final screen
    /*
    .to(
      "#pantalla-desarrollo",
      { opacity: 0, duration: 0.5, delay: 1.5 }
    )
    .to("#figura-llaves", figureExitProps, "<")
    .to("#figura-corchetes", figureExitProps, "<0.1")
    .to("#figura-bits", figureExitProps, "<0.2")
    .to("#figura-conexion", figureExitProps, "<0.3");
    */
</script>